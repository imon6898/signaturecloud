"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/fileupload/local";
exports.ids = ["pages/api/fileupload/local"];
exports.modules = {

/***/ "custom-id-new":
/*!********************************!*\
  !*** external "custom-id-new" ***!
  \********************************/
/***/ ((module) => {

module.exports = require("custom-id-new");

/***/ }),

/***/ "formidable":
/*!*****************************!*\
  !*** external "formidable" ***!
  \*****************************/
/***/ ((module) => {

module.exports = require("formidable");

/***/ }),

/***/ "next-auth/jwt":
/*!********************************!*\
  !*** external "next-auth/jwt" ***!
  \********************************/
/***/ ((module) => {

module.exports = require("next-auth/jwt");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "fs/promises":
/*!******************************!*\
  !*** external "fs/promises" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("fs/promises");

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Ffileupload%2Flocal&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Ffileupload%2Flocal.js&middlewareConfigBase64=e30%3D!":
/*!******************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Ffileupload%2Flocal&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Ffileupload%2Flocal.js&middlewareConfigBase64=e30%3D! ***!
  \******************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_fileupload_local_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages/api/fileupload/local.js */ \"(api)/./pages/api/fileupload/local.js\");\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_fileupload_local_js__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_fileupload_local_js__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/fileupload/local\",\n        pathname: \"/api/fileupload/local\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_fileupload_local_js__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRmZpbGV1cGxvYWQlMkZsb2NhbCZwcmVmZXJyZWRSZWdpb249JmFic29sdXRlUGFnZVBhdGg9LiUyRnBhZ2VzJTJGYXBpJTJGZmlsZXVwbG9hZCUyRmxvY2FsLmpzJm1pZGRsZXdhcmVDb25maWdCYXNlNjQ9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNMO0FBQzFEO0FBQzREO0FBQzVEO0FBQ0EsaUVBQWUsd0VBQUssQ0FBQywyREFBUSxZQUFZLEVBQUM7QUFDMUM7QUFDTyxlQUFlLHdFQUFLLENBQUMsMkRBQVE7QUFDcEM7QUFDTyx3QkFBd0IsZ0hBQW1CO0FBQ2xEO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLFlBQVk7QUFDWixDQUFDOztBQUVEIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbmV4dF9saWZlLz8wYTVjIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBhZ2VzQVBJUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9wYWdlcy1hcGkvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgaG9pc3QgfSBmcm9tIFwibmV4dC9kaXN0L2J1aWxkL3RlbXBsYXRlcy9oZWxwZXJzXCI7XG4vLyBJbXBvcnQgdGhlIHVzZXJsYW5kIGNvZGUuXG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiLi9wYWdlcy9hcGkvZmlsZXVwbG9hZC9sb2NhbC5qc1wiO1xuLy8gUmUtZXhwb3J0IHRoZSBoYW5kbGVyIChzaG91bGQgYmUgdGhlIGRlZmF1bHQgZXhwb3J0KS5cbmV4cG9ydCBkZWZhdWx0IGhvaXN0KHVzZXJsYW5kLCBcImRlZmF1bHRcIik7XG4vLyBSZS1leHBvcnQgY29uZmlnLlxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IGhvaXN0KHVzZXJsYW5kLCBcImNvbmZpZ1wiKTtcbi8vIENyZWF0ZSBhbmQgZXhwb3J0IHRoZSByb3V0ZSBtb2R1bGUgdGhhdCB3aWxsIGJlIGNvbnN1bWVkLlxuZXhwb3J0IGNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IFBhZ2VzQVBJUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLlBBR0VTX0FQSSxcbiAgICAgICAgcGFnZTogXCIvYXBpL2ZpbGV1cGxvYWQvbG9jYWxcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9maWxldXBsb2FkL2xvY2FsXCIsXG4gICAgICAgIC8vIFRoZSBmb2xsb3dpbmcgYXJlbid0IHVzZWQgaW4gcHJvZHVjdGlvbi5cbiAgICAgICAgYnVuZGxlUGF0aDogXCJcIixcbiAgICAgICAgZmlsZW5hbWU6IFwiXCJcbiAgICB9LFxuICAgIHVzZXJsYW5kXG59KTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cGFnZXMtYXBpLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Ffileupload%2Flocal&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Ffileupload%2Flocal.js&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./lib/sessionPermission.js":
/*!**********************************!*\
  !*** ./lib/sessionPermission.js ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ sessionChecker)\n/* harmony export */ });\n/* harmony import */ var next_auth_jwt__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next-auth/jwt */ \"next-auth/jwt\");\n/* harmony import */ var next_auth_jwt__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_auth_jwt__WEBPACK_IMPORTED_MODULE_0__);\n\nasync function sessionChecker(req, target, user) {\n    try {\n        const secret = process.env.AUTH_SECRET;\n        const session = await (0,next_auth_jwt__WEBPACK_IMPORTED_MODULE_0__.getToken)({\n            req,\n            secret\n        });\n        //no session\n        if (!session) {\n            return false;\n        }\n        //only user\n        if (session && user) {\n            return true;\n        }\n        //admin\n        if (session && session.user.a) {\n            return true;\n        }\n        //staff\n        if (session && session.user.s.status) {\n            if (target === \"general\") {\n                return true;\n            } else {\n                const { view, edit, delete: _delete } = session.user.s.permissions.find((x)=>x.name === target);\n                return view || edit || _delete;\n            }\n        } else {\n            return false;\n        }\n    } catch (err) {\n        console.log(err);\n        return false;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9saWIvc2Vzc2lvblBlcm1pc3Npb24uanMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQXlDO0FBRTFCLGVBQWVDLGVBQWVDLEdBQUcsRUFBRUMsTUFBTSxFQUFFQyxJQUFJO0lBQzVELElBQUk7UUFDRixNQUFNQyxTQUFTQyxRQUFRQyxHQUFHLENBQUNDLFdBQVc7UUFDdEMsTUFBTUMsVUFBVSxNQUFNVCx1REFBUUEsQ0FBQztZQUFFRTtZQUFLRztRQUFPO1FBQzdDLFlBQVk7UUFDWixJQUFJLENBQUNJLFNBQVM7WUFDWixPQUFPO1FBQ1Q7UUFDQSxXQUFXO1FBQ1gsSUFBSUEsV0FBV0wsTUFBTTtZQUNuQixPQUFPO1FBQ1Q7UUFDQSxPQUFPO1FBQ1AsSUFBSUssV0FBV0EsUUFBUUwsSUFBSSxDQUFDTSxDQUFDLEVBQUU7WUFDN0IsT0FBTztRQUNUO1FBQ0EsT0FBTztRQUNQLElBQUlELFdBQVdBLFFBQVFMLElBQUksQ0FBQ08sQ0FBQyxDQUFDQyxNQUFNLEVBQUU7WUFDcEMsSUFBSVQsV0FBVyxXQUFXO2dCQUN4QixPQUFPO1lBQ1QsT0FBTztnQkFDTCxNQUFNLEVBQ0pVLElBQUksRUFDSkMsSUFBSSxFQUNKQyxRQUFRQyxPQUFPLEVBQ2hCLEdBQUdQLFFBQVFMLElBQUksQ0FBQ08sQ0FBQyxDQUFDTSxXQUFXLENBQUNDLElBQUksQ0FBQyxDQUFDQyxJQUFNQSxFQUFFQyxJQUFJLEtBQUtqQjtnQkFDdEQsT0FBT1UsUUFBUUMsUUFBUUU7WUFDekI7UUFDRixPQUFPO1lBQ0wsT0FBTztRQUNUO0lBQ0YsRUFBRSxPQUFPSyxLQUFLO1FBQ1pDLFFBQVFDLEdBQUcsQ0FBQ0Y7UUFDWixPQUFPO0lBQ1Q7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL25leHRfbGlmZS8uL2xpYi9zZXNzaW9uUGVybWlzc2lvbi5qcz8yNTM1Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGdldFRva2VuIH0gZnJvbSBcIm5leHQtYXV0aC9qd3RcIjtcblxuZXhwb3J0IGRlZmF1bHQgYXN5bmMgZnVuY3Rpb24gc2Vzc2lvbkNoZWNrZXIocmVxLCB0YXJnZXQsIHVzZXIpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCBzZWNyZXQgPSBwcm9jZXNzLmVudi5BVVRIX1NFQ1JFVDtcbiAgICBjb25zdCBzZXNzaW9uID0gYXdhaXQgZ2V0VG9rZW4oeyByZXEsIHNlY3JldCB9KTtcbiAgICAvL25vIHNlc3Npb25cbiAgICBpZiAoIXNlc3Npb24pIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgLy9vbmx5IHVzZXJcbiAgICBpZiAoc2Vzc2lvbiAmJiB1c2VyKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgLy9hZG1pblxuICAgIGlmIChzZXNzaW9uICYmIHNlc3Npb24udXNlci5hKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgLy9zdGFmZlxuICAgIGlmIChzZXNzaW9uICYmIHNlc3Npb24udXNlci5zLnN0YXR1cykge1xuICAgICAgaWYgKHRhcmdldCA9PT0gXCJnZW5lcmFsXCIpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCB7XG4gICAgICAgICAgdmlldyxcbiAgICAgICAgICBlZGl0LFxuICAgICAgICAgIGRlbGV0ZTogX2RlbGV0ZSxcbiAgICAgICAgfSA9IHNlc3Npb24udXNlci5zLnBlcm1pc3Npb25zLmZpbmQoKHgpID0+IHgubmFtZSA9PT0gdGFyZ2V0KTtcbiAgICAgICAgcmV0dXJuIHZpZXcgfHwgZWRpdCB8fCBfZGVsZXRlO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9IGNhdGNoIChlcnIpIHtcbiAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbImdldFRva2VuIiwic2Vzc2lvbkNoZWNrZXIiLCJyZXEiLCJ0YXJnZXQiLCJ1c2VyIiwic2VjcmV0IiwicHJvY2VzcyIsImVudiIsIkFVVEhfU0VDUkVUIiwic2Vzc2lvbiIsImEiLCJzIiwic3RhdHVzIiwidmlldyIsImVkaXQiLCJkZWxldGUiLCJfZGVsZXRlIiwicGVybWlzc2lvbnMiLCJmaW5kIiwieCIsIm5hbWUiLCJlcnIiLCJjb25zb2xlIiwibG9nIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./lib/sessionPermission.js\n");

/***/ }),

/***/ "(api)/./middleware/functions.js":
/*!*********************************!*\
  !*** ./middleware/functions.js ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   convertToSlug: () => (/* binding */ convertToSlug),\n/* harmony export */   deleteMultiple: () => (/* binding */ deleteMultiple),\n/* harmony export */   deleteOne: () => (/* binding */ deleteOne)\n/* harmony export */ });\n/* harmony import */ var fs_promises__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! fs/promises */ \"fs/promises\");\n/* harmony import */ var fs_promises__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(fs_promises__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var custom_id_new__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! custom-id-new */ \"custom-id-new\");\n/* harmony import */ var custom_id_new__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(custom_id_new__WEBPACK_IMPORTED_MODULE_1__);\n\n\nasync function deleteOne(file) {\n    try {\n        const filePath = `./public/uploads/${file}`;\n        await (0,fs_promises__WEBPACK_IMPORTED_MODULE_0__.unlink)(filePath);\n    } catch (err) {\n        console.log(err);\n    }\n}\nasync function deleteMultiple(files) {\n    try {\n        for(let i = 0; i < files.length; i++){\n            const file = files[i];\n            const filePath = `./public/uploads/${file}`;\n            await (0,fs_promises__WEBPACK_IMPORTED_MODULE_0__.unlink)(filePath);\n        }\n    } catch (err) {\n        console.log(err);\n    }\n}\nfunction convertToSlug(string, randomId) {\n    const str = string.toString().trim().toLowerCase().replace(\"&\", \"and\").replace(/\\s+/g, \"-\").replace(/[^\\p{L}\\p{N}\\p{M}-]+/gu, \"-\").replace(/\\-\\-+/g, \"-\").replace(/^-+/, \"\").replace(/-+$/, \"\");\n    if (randomId) {\n        const cid = custom_id_new__WEBPACK_IMPORTED_MODULE_1___default()({\n            randomLength: 2,\n            lowerCase: true\n        });\n        const slug = `${str}-${cid}`;\n        return slug;\n    } else {\n        return str;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9taWRkbGV3YXJlL2Z1bmN0aW9ucy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQXFDO0FBQ0E7QUFFOUIsZUFBZUUsVUFBVUMsSUFBSTtJQUNsQyxJQUFJO1FBQ0YsTUFBTUMsV0FBVyxDQUFDLGlCQUFpQixFQUFFRCxLQUFLLENBQUM7UUFDM0MsTUFBTUgsbURBQU1BLENBQUNJO0lBQ2YsRUFBRSxPQUFPQyxLQUFLO1FBQ1pDLFFBQVFDLEdBQUcsQ0FBQ0Y7SUFDZDtBQUNGO0FBQ08sZUFBZUcsZUFBZUMsS0FBSztJQUN4QyxJQUFJO1FBQ0YsSUFBSyxJQUFJQyxJQUFJLEdBQUdBLElBQUlELE1BQU1FLE1BQU0sRUFBRUQsSUFBSztZQUNyQyxNQUFNUCxPQUFPTSxLQUFLLENBQUNDLEVBQUU7WUFDckIsTUFBTU4sV0FBVyxDQUFDLGlCQUFpQixFQUFFRCxLQUFLLENBQUM7WUFDM0MsTUFBTUgsbURBQU1BLENBQUNJO1FBQ2Y7SUFDRixFQUFFLE9BQU9DLEtBQUs7UUFDWkMsUUFBUUMsR0FBRyxDQUFDRjtJQUNkO0FBQ0Y7QUFFTyxTQUFTTyxjQUFjQyxNQUFNLEVBQUVDLFFBQVE7SUFDNUMsTUFBTUMsTUFBTUYsT0FDVEcsUUFBUSxHQUNSQyxJQUFJLEdBQ0pDLFdBQVcsR0FDWEMsT0FBTyxDQUFDLEtBQUssT0FDYkEsT0FBTyxDQUFDLFFBQVEsS0FDaEJBLE9BQU8sQ0FBQywwQkFBMEIsS0FDbENBLE9BQU8sQ0FBQyxVQUFVLEtBQ2xCQSxPQUFPLENBQUMsT0FBTyxJQUNmQSxPQUFPLENBQUMsT0FBTztJQUVsQixJQUFJTCxVQUFVO1FBQ1osTUFBTU0sTUFBTW5CLG9EQUFRQSxDQUFDO1lBQUVvQixjQUFjO1lBQUdDLFdBQVc7UUFBSztRQUN4RCxNQUFNQyxPQUFPLENBQUMsRUFBRVIsSUFBSSxDQUFDLEVBQUVLLElBQUksQ0FBQztRQUM1QixPQUFPRztJQUNULE9BQU87UUFDTCxPQUFPUjtJQUNUO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9uZXh0X2xpZmUvLi9taWRkbGV3YXJlL2Z1bmN0aW9ucy5qcz8wNmE3Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHVubGluayB9IGZyb20gXCJmcy9wcm9taXNlc1wiO1xuaW1wb3J0IGN1c3RvbUlkIGZyb20gXCJjdXN0b20taWQtbmV3XCI7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVPbmUoZmlsZSkge1xuICB0cnkge1xuICAgIGNvbnN0IGZpbGVQYXRoID0gYC4vcHVibGljL3VwbG9hZHMvJHtmaWxlfWA7XG4gICAgYXdhaXQgdW5saW5rKGZpbGVQYXRoKTtcbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgY29uc29sZS5sb2coZXJyKTtcbiAgfVxufVxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZU11bHRpcGxlKGZpbGVzKSB7XG4gIHRyeSB7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBmaWxlcy5sZW5ndGg7IGkrKykge1xuICAgICAgY29uc3QgZmlsZSA9IGZpbGVzW2ldO1xuICAgICAgY29uc3QgZmlsZVBhdGggPSBgLi9wdWJsaWMvdXBsb2Fkcy8ke2ZpbGV9YDtcbiAgICAgIGF3YWl0IHVubGluayhmaWxlUGF0aCk7XG4gICAgfVxuICB9IGNhdGNoIChlcnIpIHtcbiAgICBjb25zb2xlLmxvZyhlcnIpO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjb252ZXJ0VG9TbHVnKHN0cmluZywgcmFuZG9tSWQpIHtcbiAgY29uc3Qgc3RyID0gc3RyaW5nXG4gICAgLnRvU3RyaW5nKClcbiAgICAudHJpbSgpXG4gICAgLnRvTG93ZXJDYXNlKClcbiAgICAucmVwbGFjZShcIiZcIiwgXCJhbmRcIilcbiAgICAucmVwbGFjZSgvXFxzKy9nLCBcIi1cIilcbiAgICAucmVwbGFjZSgvW15cXHB7TH1cXHB7Tn1cXHB7TX0tXSsvZ3UsIFwiLVwiKVxuICAgIC5yZXBsYWNlKC9cXC1cXC0rL2csIFwiLVwiKVxuICAgIC5yZXBsYWNlKC9eLSsvLCBcIlwiKVxuICAgIC5yZXBsYWNlKC8tKyQvLCBcIlwiKTtcblxuICBpZiAocmFuZG9tSWQpIHtcbiAgICBjb25zdCBjaWQgPSBjdXN0b21JZCh7IHJhbmRvbUxlbmd0aDogMiwgbG93ZXJDYXNlOiB0cnVlIH0pO1xuICAgIGNvbnN0IHNsdWcgPSBgJHtzdHJ9LSR7Y2lkfWA7XG4gICAgcmV0dXJuIHNsdWc7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIHN0cjtcbiAgfVxufVxuIl0sIm5hbWVzIjpbInVubGluayIsImN1c3RvbUlkIiwiZGVsZXRlT25lIiwiZmlsZSIsImZpbGVQYXRoIiwiZXJyIiwiY29uc29sZSIsImxvZyIsImRlbGV0ZU11bHRpcGxlIiwiZmlsZXMiLCJpIiwibGVuZ3RoIiwiY29udmVydFRvU2x1ZyIsInN0cmluZyIsInJhbmRvbUlkIiwic3RyIiwidG9TdHJpbmciLCJ0cmltIiwidG9Mb3dlckNhc2UiLCJyZXBsYWNlIiwiY2lkIiwicmFuZG9tTGVuZ3RoIiwibG93ZXJDYXNlIiwic2x1ZyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./middleware/functions.js\n");

/***/ }),

/***/ "(api)/./pages/api/fileupload/local.js":
/*!***************************************!*\
  !*** ./pages/api/fileupload/local.js ***!
  \***************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (/* binding */ apiHandler)\n/* harmony export */ });\n/* harmony import */ var custom_id_new__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! custom-id-new */ \"custom-id-new\");\n/* harmony import */ var custom_id_new__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(custom_id_new__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _lib_sessionPermission__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ~/lib/sessionPermission */ \"(api)/./lib/sessionPermission.js\");\n/* harmony import */ var _middleware_functions__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ~/middleware/functions */ \"(api)/./middleware/functions.js\");\n/* harmony import */ var _utils_parseForm__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ~/utils/parseForm */ \"(api)/./utils/parseForm.js\");\n\n\n\n\nconst config = {\n    api: {\n        bodyParser: false\n    }\n};\nasync function apiHandler(req, res) {\n    const { method } = req;\n    if (!await (0,_lib_sessionPermission__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(req, \"general\", true)) return res.status(403).json({\n        success: false,\n        message: \"Access Forbidden\"\n    });\n    switch(method){\n        case \"POST\":\n            try {\n                const result = await (0,_utils_parseForm__WEBPACK_IMPORTED_MODULE_3__.parseForm)(req);\n                const imageName = result.file.file.newFilename;\n                const url = `${\"http://localhost:30008\"}/${imageName}`;\n                res.status(200).json({\n                    success: true,\n                    name: imageName,\n                    url\n                });\n            } catch (err) {\n                console.log(err);\n                res.status(500).json({\n                    success: false,\n                    err: err.message\n                });\n            }\n            break;\n        case \"DELETE\":\n            try {\n                const { query } = req;\n                await (0,_middleware_functions__WEBPACK_IMPORTED_MODULE_2__.deleteOne)(query.name);\n                res.status(200).json({\n                    success: true,\n                    err: null\n                });\n            } catch (err) {\n                console.log(err);\n                res.status(500).json({\n                    success: false,\n                    err: err.message\n                });\n            }\n            break;\n        default:\n            res.status(400).json({\n                success: false\n            });\n            break;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9wYWdlcy9hcGkvZmlsZXVwbG9hZC9sb2NhbC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQXFDO0FBQ2dCO0FBQ0Y7QUFDTDtBQUV2QyxNQUFNSSxTQUFTO0lBQ3BCQyxLQUFLO1FBQ0hDLFlBQVk7SUFDZDtBQUNGLEVBQUU7QUFFYSxlQUFlQyxXQUFXQyxHQUFHLEVBQUVDLEdBQUc7SUFDL0MsTUFBTSxFQUFFQyxNQUFNLEVBQUUsR0FBR0Y7SUFDbkIsSUFBSSxDQUFFLE1BQU1QLGtFQUFjQSxDQUFDTyxLQUFLLFdBQVcsT0FDekMsT0FBT0MsSUFDSkUsTUFBTSxDQUFDLEtBQ1BDLElBQUksQ0FBQztRQUFFQyxTQUFTO1FBQU9DLFNBQVM7SUFBbUI7SUFFeEQsT0FBUUo7UUFDTixLQUFLO1lBQ0gsSUFBSTtnQkFDRixNQUFNSyxTQUFTLE1BQU1aLDJEQUFTQSxDQUFDSztnQkFDL0IsTUFBTVEsWUFBWUQsT0FBT0UsSUFBSSxDQUFDQSxJQUFJLENBQUNDLFdBQVc7Z0JBQzlDLE1BQU1DLE1BQU0sQ0FBQyxFQUFFQyx3QkFBMkIsQ0FBQyxDQUFDLEVBQUVKLFVBQVUsQ0FBQztnQkFDekRQLElBQUlFLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7b0JBQUVDLFNBQVM7b0JBQU1VLE1BQU1QO29CQUFXRztnQkFBSTtZQUM3RCxFQUFFLE9BQU9LLEtBQUs7Z0JBQ1pDLFFBQVFDLEdBQUcsQ0FBQ0Y7Z0JBQ1pmLElBQUlFLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7b0JBQUVDLFNBQVM7b0JBQU9XLEtBQUtBLElBQUlWLE9BQU87Z0JBQUM7WUFDMUQ7WUFDQTtRQUVGLEtBQUs7WUFDSCxJQUFJO2dCQUNGLE1BQU0sRUFBRWEsS0FBSyxFQUFFLEdBQUduQjtnQkFDbEIsTUFBTU4sZ0VBQVNBLENBQUN5QixNQUFNSixJQUFJO2dCQUMxQmQsSUFBSUUsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztvQkFBRUMsU0FBUztvQkFBTVcsS0FBSztnQkFBSztZQUNsRCxFQUFFLE9BQU9BLEtBQUs7Z0JBQ1pDLFFBQVFDLEdBQUcsQ0FBQ0Y7Z0JBQ1pmLElBQUlFLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7b0JBQUVDLFNBQVM7b0JBQU9XLEtBQUtBLElBQUlWLE9BQU87Z0JBQUM7WUFDMUQ7WUFDQTtRQUVGO1lBQ0VMLElBQUlFLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7Z0JBQUVDLFNBQVM7WUFBTTtZQUN0QztJQUNKO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9uZXh0X2xpZmUvLi9wYWdlcy9hcGkvZmlsZXVwbG9hZC9sb2NhbC5qcz9jZmNiIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBjdXN0b21JZCBmcm9tIFwiY3VzdG9tLWlkLW5ld1wiO1xuaW1wb3J0IHNlc3Npb25DaGVja2VyIGZyb20gXCJ+L2xpYi9zZXNzaW9uUGVybWlzc2lvblwiO1xuaW1wb3J0IHsgZGVsZXRlT25lIH0gZnJvbSBcIn4vbWlkZGxld2FyZS9mdW5jdGlvbnNcIjtcbmltcG9ydCB7IHBhcnNlRm9ybSB9IGZyb20gXCJ+L3V0aWxzL3BhcnNlRm9ybVwiO1xuXG5leHBvcnQgY29uc3QgY29uZmlnID0ge1xuICBhcGk6IHtcbiAgICBib2R5UGFyc2VyOiBmYWxzZSxcbiAgfSxcbn07XG5cbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uIGFwaUhhbmRsZXIocmVxLCByZXMpIHtcbiAgY29uc3QgeyBtZXRob2QgfSA9IHJlcTtcbiAgaWYgKCEoYXdhaXQgc2Vzc2lvbkNoZWNrZXIocmVxLCBcImdlbmVyYWxcIiwgdHJ1ZSkpKVxuICAgIHJldHVybiByZXNcbiAgICAgIC5zdGF0dXMoNDAzKVxuICAgICAgLmpzb24oeyBzdWNjZXNzOiBmYWxzZSwgbWVzc2FnZTogXCJBY2Nlc3MgRm9yYmlkZGVuXCIgfSk7XG5cbiAgc3dpdGNoIChtZXRob2QpIHtcbiAgICBjYXNlIFwiUE9TVFwiOlxuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcGFyc2VGb3JtKHJlcSk7XG4gICAgICAgIGNvbnN0IGltYWdlTmFtZSA9IHJlc3VsdC5maWxlLmZpbGUubmV3RmlsZW5hbWU7XG4gICAgICAgIGNvbnN0IHVybCA9IGAke3Byb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1VSTH0vJHtpbWFnZU5hbWV9YDtcbiAgICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24oeyBzdWNjZXNzOiB0cnVlLCBuYW1lOiBpbWFnZU5hbWUsIHVybCB9KTtcbiAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgICAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IHN1Y2Nlc3M6IGZhbHNlLCBlcnI6IGVyci5tZXNzYWdlIH0pO1xuICAgICAgfVxuICAgICAgYnJlYWs7XG5cbiAgICBjYXNlIFwiREVMRVRFXCI6XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCB7IHF1ZXJ5IH0gPSByZXE7XG4gICAgICAgIGF3YWl0IGRlbGV0ZU9uZShxdWVyeS5uYW1lKTtcbiAgICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24oeyBzdWNjZXNzOiB0cnVlLCBlcnI6IG51bGwgfSk7XG4gICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBzdWNjZXNzOiBmYWxzZSwgZXJyOiBlcnIubWVzc2FnZSB9KTtcbiAgICAgIH1cbiAgICAgIGJyZWFrO1xuXG4gICAgZGVmYXVsdDpcbiAgICAgIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgc3VjY2VzczogZmFsc2UgfSk7XG4gICAgICBicmVhaztcbiAgfVxufVxuIl0sIm5hbWVzIjpbImN1c3RvbUlkIiwic2Vzc2lvbkNoZWNrZXIiLCJkZWxldGVPbmUiLCJwYXJzZUZvcm0iLCJjb25maWciLCJhcGkiLCJib2R5UGFyc2VyIiwiYXBpSGFuZGxlciIsInJlcSIsInJlcyIsIm1ldGhvZCIsInN0YXR1cyIsImpzb24iLCJzdWNjZXNzIiwibWVzc2FnZSIsInJlc3VsdCIsImltYWdlTmFtZSIsImZpbGUiLCJuZXdGaWxlbmFtZSIsInVybCIsInByb2Nlc3MiLCJlbnYiLCJORVhUX1BVQkxJQ19VUkwiLCJuYW1lIiwiZXJyIiwiY29uc29sZSIsImxvZyIsInF1ZXJ5Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./pages/api/fileupload/local.js\n");

/***/ }),

/***/ "(api)/./utils/parseForm.js":
/*!****************************!*\
  !*** ./utils/parseForm.js ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   parseForm: () => (/* binding */ parseForm),\n/* harmony export */   parseFormMultiple: () => (/* binding */ parseFormMultiple)\n/* harmony export */ });\n/* harmony import */ var formidable__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! formidable */ \"formidable\");\n/* harmony import */ var formidable__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(formidable__WEBPACK_IMPORTED_MODULE_0__);\n\nfunction parseForm(req) {\n    return new Promise((resolve, reject)=>{\n        const form = formidable__WEBPACK_IMPORTED_MODULE_0___default()({\n            keepExtensions: true,\n            uploadDir: \"./public/uploads\"\n        });\n        form.parse(req, (err, fields, files)=>{\n            if (err) return reject(err);\n            const data = {\n                field: fields,\n                file: files\n            };\n            resolve(data);\n        });\n    });\n}\nfunction parseFormMultiple(req) {\n    return new Promise((resolve, reject)=>{\n        const form = formidable__WEBPACK_IMPORTED_MODULE_0___default()({\n            multiples: true,\n            keepExtensions: true,\n            uploadDir: \"./public/uploads\"\n        });\n        form.parse(req, (err, fields, files)=>{\n            if (err) return reject(err);\n            const data = {\n                field: fields,\n                file: files\n            };\n            resolve(data);\n        });\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi91dGlscy9wYXJzZUZvcm0uanMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFvQztBQUU3QixTQUFTQyxVQUFVQyxHQUFHO0lBQzNCLE9BQU8sSUFBSUMsUUFBUSxDQUFDQyxTQUFTQztRQUMzQixNQUFNQyxPQUFPTixpREFBVUEsQ0FBQztZQUN0Qk8sZ0JBQWdCO1lBQ2hCQyxXQUFXO1FBQ2I7UUFDQUYsS0FBS0csS0FBSyxDQUFDUCxLQUFLLENBQUNRLEtBQUtDLFFBQVFDO1lBQzVCLElBQUlGLEtBQUssT0FBT0wsT0FBT0s7WUFDdkIsTUFBTUcsT0FBTztnQkFBRUMsT0FBT0g7Z0JBQVFJLE1BQU1IO1lBQU07WUFDMUNSLFFBQVFTO1FBQ1Y7SUFDRjtBQUNGO0FBRU8sU0FBU0csa0JBQWtCZCxHQUFHO0lBQ25DLE9BQU8sSUFBSUMsUUFBUSxDQUFDQyxTQUFTQztRQUMzQixNQUFNQyxPQUFPTixpREFBVUEsQ0FBQztZQUN0QmlCLFdBQVc7WUFDWFYsZ0JBQWdCO1lBQ2hCQyxXQUFXO1FBQ2I7UUFDQUYsS0FBS0csS0FBSyxDQUFDUCxLQUFLLENBQUNRLEtBQUtDLFFBQVFDO1lBQzVCLElBQUlGLEtBQUssT0FBT0wsT0FBT0s7WUFDdkIsTUFBTUcsT0FBTztnQkFBRUMsT0FBT0g7Z0JBQVFJLE1BQU1IO1lBQU07WUFDMUNSLFFBQVFTO1FBQ1Y7SUFDRjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbmV4dF9saWZlLy4vdXRpbHMvcGFyc2VGb3JtLmpzP2Y1ZGYiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGZvcm1pZGFibGUgZnJvbSBcImZvcm1pZGFibGVcIjtcblxuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlRm9ybShyZXEpIHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICBjb25zdCBmb3JtID0gZm9ybWlkYWJsZSh7XG4gICAgICBrZWVwRXh0ZW5zaW9uczogdHJ1ZSxcbiAgICAgIHVwbG9hZERpcjogXCIuL3B1YmxpYy91cGxvYWRzXCIsXG4gICAgfSk7XG4gICAgZm9ybS5wYXJzZShyZXEsIChlcnIsIGZpZWxkcywgZmlsZXMpID0+IHtcbiAgICAgIGlmIChlcnIpIHJldHVybiByZWplY3QoZXJyKTtcbiAgICAgIGNvbnN0IGRhdGEgPSB7IGZpZWxkOiBmaWVsZHMsIGZpbGU6IGZpbGVzIH07XG4gICAgICByZXNvbHZlKGRhdGEpO1xuICAgIH0pO1xuICB9KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlRm9ybU11bHRpcGxlKHJlcSkge1xuICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgIGNvbnN0IGZvcm0gPSBmb3JtaWRhYmxlKHtcbiAgICAgIG11bHRpcGxlczogdHJ1ZSxcbiAgICAgIGtlZXBFeHRlbnNpb25zOiB0cnVlLFxuICAgICAgdXBsb2FkRGlyOiBcIi4vcHVibGljL3VwbG9hZHNcIixcbiAgICB9KTtcbiAgICBmb3JtLnBhcnNlKHJlcSwgKGVyciwgZmllbGRzLCBmaWxlcykgPT4ge1xuICAgICAgaWYgKGVycikgcmV0dXJuIHJlamVjdChlcnIpO1xuICAgICAgY29uc3QgZGF0YSA9IHsgZmllbGQ6IGZpZWxkcywgZmlsZTogZmlsZXMgfTtcbiAgICAgIHJlc29sdmUoZGF0YSk7XG4gICAgfSk7XG4gIH0pO1xufVxuIl0sIm5hbWVzIjpbImZvcm1pZGFibGUiLCJwYXJzZUZvcm0iLCJyZXEiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsImZvcm0iLCJrZWVwRXh0ZW5zaW9ucyIsInVwbG9hZERpciIsInBhcnNlIiwiZXJyIiwiZmllbGRzIiwiZmlsZXMiLCJkYXRhIiwiZmllbGQiLCJmaWxlIiwicGFyc2VGb3JtTXVsdGlwbGUiLCJtdWx0aXBsZXMiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./utils/parseForm.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Ffileupload%2Flocal&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Ffileupload%2Flocal.js&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();